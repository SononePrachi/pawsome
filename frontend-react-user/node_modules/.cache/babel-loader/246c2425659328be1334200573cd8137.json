{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP\\\\Desktop\\\\FinalProject\\\\Project_Pawsome\\\\frontend-react-user\\\\src\\\\user\\\\Payment.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport sweetalert from \"sweetalert\";\nimport { useSearchParams } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Payment() {\n  _s();\n\n  const [loading, setLoading] = useState(false);\n  const searchParams = new URLSearchParams(window.location.search);\n  const redirect = searchParams.get(\"redirect\");\n  const [orderAmount, setOrderAmount] = useState(new Number(searchParams.get(\"amount\")));\n  useEffect(() => {\n    if (localStorage.getItem(\"role\") === \"null\" || localStorage.getItem(\"role\") != \"3\") {\n      window.location.href = \"/login\";\n    } //  getAllGrounds();\n\n  }, []);\n  /*const [orders, setOrders] = useState([]);\r\n    async function fetchOrders() {\r\n    const { data } = await axios.get(\"/list-orders\");\r\n    setOrders(data);\r\n  }\r\n  useEffect(() => {\r\n    fetchOrders();\r\n  }, []);*/\n\n  function loadRazorpay() {\n    console.log(\"Inside\");\n    const script = document.createElement(\"script\");\n    script.src = \"https://checkout.razorpay.com/v1/checkout.js\";\n\n    script.onerror = () => {\n      alert(\"Razorpay SDK failed to load. Are you online?\");\n    };\n\n    script.onload = async () => {\n      try {\n        setLoading(true);\n        const result = await axios.post(\"http://localhost:8081/create_order\", {\n          amount: orderAmount,\n          userid: localStorage.getItem(\"userid\")\n        });\n        console.log(\"result\");\n        console.log(result);\n        const {\n          amount,\n          id: order_id,\n          currency\n        } = result.data;\n        const {\n          data: {\n            key: razorpayKey\n          }\n        } = await axios.get(\"http://localhost:8081/get-razorpay-key\");\n        const options = {\n          key: razorpayKey,\n          amount: amount.toString(),\n          currency: currency,\n          name: \"example name\",\n          description: \"example transaction\",\n          order_id: order_id,\n          handler: async function (response) {\n            const result = await axios.post(\"http://localhost:8081/pay-order\", {\n              amount: amount,\n              razorpayPaymentId: response.razorpay_payment_id,\n              razorpayOrderId: response.razorpay_order_id,\n              razorpaySignature: response.razorpay_signature\n            }); // if(result.data.stat)\n\n            console.log(result); //  console.log(localStorage.getItem(\"userid\"));\n\n            sweetalert(\"success\", \"Your Payment has been successfully done..\", \"success\"); //fetchOrders();\n\n            window.location.href = \"/\" + redirect;\n          },\n          prefill: {\n            name: \"example name\",\n            email: \"email@example.com\",\n            contact: \"111111\"\n          },\n          notes: {\n            address: \"example address\"\n          },\n          theme: {\n            color: \"#80c0f0\"\n          }\n        };\n        setLoading(false);\n        const paymentObject = new window.Razorpay(options);\n        paymentObject.open();\n      } catch (err) {\n        alert(err);\n        setLoading(false);\n      }\n    };\n\n    document.body.appendChild(script);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    class: \"mt-5\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \" Pay Order\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            placeholder: \"INR\",\n            type: \"text\",\n            value: orderAmount,\n            readOnly: true,\n            onChange: e => setOrderAmount(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-primary\",\n        disabled: loading,\n        onClick: loadRazorpay,\n        children: \"Pay\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 110,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Payment, \"1BlQkh8O1DEHyxHJ/1dqtVLA7os=\");\n\n_c = Payment;\nexport default Payment;\n\nvar _c;\n\n$RefreshReg$(_c, \"Payment\");","map":{"version":3,"names":["React","useEffect","useState","axios","sweetalert","useSearchParams","Payment","loading","setLoading","searchParams","URLSearchParams","window","location","search","redirect","get","orderAmount","setOrderAmount","Number","localStorage","getItem","href","loadRazorpay","console","log","script","document","createElement","src","onerror","alert","onload","result","post","amount","userid","id","order_id","currency","data","key","razorpayKey","options","toString","name","description","handler","response","razorpayPaymentId","razorpay_payment_id","razorpayOrderId","razorpay_order_id","razorpaySignature","razorpay_signature","prefill","email","contact","notes","address","theme","color","paymentObject","Razorpay","open","err","body","appendChild","e","target","value"],"sources":["C:/Users/HP/Desktop/FinalProject/Project_Pawsome/frontend-react-user/src/user/Payment.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport sweetalert from \"sweetalert\";\r\nimport { useSearchParams } from \"react-router-dom\";\r\n\r\nfunction Payment() {\r\n  const [loading, setLoading] = useState(false);\r\n  const searchParams = new URLSearchParams(window.location.search);\r\n\r\n  const redirect = searchParams.get(\"redirect\");\r\n  const [orderAmount, setOrderAmount] = useState(\r\n    new Number(searchParams.get(\"amount\"))\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (\r\n      localStorage.getItem(\"role\") === \"null\" ||\r\n      localStorage.getItem(\"role\") != \"3\"\r\n    ) {\r\n      window.location.href = \"/login\";\r\n    }\r\n    //  getAllGrounds();\r\n  }, []);\r\n\r\n  /*const [orders, setOrders] = useState([]);\r\n\r\n  async function fetchOrders() {\r\n    const { data } = await axios.get(\"/list-orders\");\r\n    setOrders(data);\r\n  }\r\n  useEffect(() => {\r\n    fetchOrders();\r\n  }, []);*/\r\n\r\n  function loadRazorpay() {\r\n    console.log(\"Inside\");\r\n\r\n    const script = document.createElement(\"script\");\r\n    script.src = \"https://checkout.razorpay.com/v1/checkout.js\";\r\n    script.onerror = () => {\r\n      alert(\"Razorpay SDK failed to load. Are you online?\");\r\n    };\r\n    script.onload = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const result = await axios.post(\"http://localhost:8081/create_order\", {\r\n          amount: orderAmount,\r\n          userid: localStorage.getItem(\"userid\"),\r\n        });\r\n        console.log(\"result\");\r\n        console.log(result);\r\n        const { amount, id: order_id, currency } = result.data;\r\n        const {\r\n          data: { key: razorpayKey },\r\n        } = await axios.get(\"http://localhost:8081/get-razorpay-key\");\r\n\r\n        const options = {\r\n          key: razorpayKey,\r\n          amount: amount.toString(),\r\n          currency: currency,\r\n          name: \"example name\",\r\n          description: \"example transaction\",\r\n          order_id: order_id,\r\n          handler: async function (response) {\r\n            const result = await axios.post(\"http://localhost:8081/pay-order\", {\r\n              amount: amount,\r\n              razorpayPaymentId: response.razorpay_payment_id,\r\n              razorpayOrderId: response.razorpay_order_id,\r\n              razorpaySignature: response.razorpay_signature,\r\n            });\r\n            // if(result.data.stat)\r\n            console.log(result);\r\n\r\n            //  console.log(localStorage.getItem(\"userid\"));\r\n            sweetalert(\r\n              \"success\",\r\n              \"Your Payment has been successfully done..\",\r\n              \"success\"\r\n            );\r\n\r\n            //fetchOrders();\r\n            window.location.href = \"/\" + redirect;\r\n          },\r\n\r\n          prefill: {\r\n            name: \"example name\",\r\n            email: \"email@example.com\",\r\n            contact: \"111111\",\r\n          },\r\n          notes: {\r\n            address: \"example address\",\r\n          },\r\n          theme: {\r\n            color: \"#80c0f0\",\r\n          },\r\n        };\r\n\r\n        setLoading(false);\r\n        const paymentObject = new window.Razorpay(options);\r\n        paymentObject.open();\r\n      } catch (err) {\r\n        alert(err);\r\n        setLoading(false);\r\n      }\r\n    };\r\n    document.body.appendChild(script);\r\n  }\r\n\r\n  return (\r\n    <div class=\"mt-5\">\r\n      <div>\r\n        <div>\r\n          <h2> Pay Order</h2>\r\n        </div>\r\n\r\n        <div>\r\n          <label>\r\n            <input\r\n              placeholder=\"INR\"\r\n              type=\"text\"\r\n              value={orderAmount}\r\n              readOnly\r\n              onChange={(e) => setOrderAmount(e.target.value)}\r\n            ></input>\r\n          </label>\r\n        </div>\r\n\r\n        <button\r\n          className=\"btn btn-primary\"\r\n          disabled={loading}\r\n          onClick={loadRazorpay}\r\n        >\r\n          Pay\r\n        </button>\r\n\r\n        {loading && <div>Loading...</div>}\r\n      </div>\r\n      {/* <div className=\"list-orders\">\r\n        <h2>List Orders</h2>\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th>ID</th>\r\n              <th>AMOUNT</th>\r\n              <th>ISPAID</th>\r\n              <th>RAZORPAY</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {orders.map((x) => (\r\n              <tr key={x._id}>\r\n                <td>{x._id}</td>\r\n                <td>{x.amount / 100}</td>\r\n                <td>{x.isPaid ? \"YES\" : \"NO\"}</td>\r\n                <td>{x.razorpay.paymentId}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div> */}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Payment;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}